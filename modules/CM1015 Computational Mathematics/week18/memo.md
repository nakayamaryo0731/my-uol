# Week 18: 同次座標（Homogeneous Coordinates）

## 1. 問題点：2×2行列の限界

2×2行列では**平行移動（translation）ができない**

```
| a  b |   | 0 |   | 0 |
| c  d | × | 0 | = | 0 |
```

原点 (0,0) は常に (0,0) にマッピングされる → 図形を移動できない

---

## 2. 解決策：同次座標

### 基本ルール
- 点 **(x, y) → (x, y, 1)** に拡張
- 2×2行列を3×3行列に拡張
- **最下行は常に [0 0 1]**（これが崩れたら間違い）

### 2×2 → 3×3 への変換
```
| a  b |        | a  b  0 |
| c  d |   →    | c  d  0 |
                | 0  0  1 |
```

---

## 3. 平行移動行列（Translation）

点 (x, y) を (x+a, y+b) に移動：
```
| 1  0  a |   | x |   | x + a |
| 0  1  b | × | y | = | y + b |
| 0  0  1 |   | 1 |   |   1   |
```

**例：** 三角形 (0,0), (2,0), (2,1) を a=3, b=2 移動
```
| 1  0  3 |
| 0  1  2 |
| 0  0  1 |
```
結果：(3,2), (5,2), (5,3)

---

## 4. 同次座標での各変換行列

### 平行移動（a, b）
```
| 1  0  a |
| 0  1  b |
| 0  0  1 |
```

### 拡大（kx, ky）
```
| kx  0  0 |
|  0 ky  0 |
|  0  0  1 |
```

### 回転（θ、反時計回り）
```
| cos θ  -sin θ  0 |
| sin θ   cos θ  0 |
|   0       0    1 |
```

### 反射（x軸）
```
| 1   0  0 |
| 0  -1  0 |
| 0   0  1 |
```

### 反射（y軸）
```
| -1  0  0 |
|  0  1  0 |
|  0  0  1 |
```

---

## 5. 変換の合成（複数の変換）

**B を先に適用し、次に A を適用** → 行列は **A × B**

### 例：拡大 B → 平行移動 A

B = 拡大（x方向3倍、y方向2倍）：
```
| 3  0  0 |
| 0  2  0 |
| 0  0  1 |
```

A = 平行移動（+5, +4）：
```
| 1  0  5 |
| 0  1  4 |
| 0  0  1 |
```

合成 AB：
```
| 1  0  5 |   | 3  0  0 |   | 3  0  5 |
| 0  1  4 | × | 0  2  0 | = | 0  2  4 |
| 0  0  1 |   | 0  0  1 |   | 0  0  1 |
```

---

## 6. 逆変換の重要公式

### 公式
$$(AB)^{-1} = B^{-1} A^{-1}$$

**順序が逆になる！**

### 各変換の逆行列

| 変換 | 元の行列 | 逆行列 |
|------|----------|--------|
| 平行移動 (a, b) | [1,0,a; 0,1,b; 0,0,1] | [1,0,-a; 0,1,-b; 0,0,1] |
| 拡大 (kx, ky) | [kx,0,0; 0,ky,0; 0,0,1] | [1/kx,0,0; 0,1/ky,0; 0,0,1] |

### 例：AB の逆行列

AB = [3,0,5; 0,2,4; 0,0,1] の場合：

A⁻¹（平行移動の逆）：
```
| 1  0  -5 |
| 0  1  -4 |
| 0  0   1 |
```

B⁻¹（拡大の逆）：
```
| 1/3   0   0 |
|  0   1/2  0 |
|  0    0   1 |
```

(AB)⁻¹ = B⁻¹ × A⁻¹：
```
| 1/3   0   -5/3 |
|  0   1/2   -2  |
|  0    0     1  |
```

検証：AB × (AB)⁻¹ = 単位行列 ✓

---

## 7. クイック参照表

| 変換 | 同次座標行列 |
|------|-------------|
| 平行移動 (a, b) | `[1,0,a; 0,1,b; 0,0,1]` |
| 拡大 (k) | `[k,0,0; 0,k,0; 0,0,1]` |
| 回転 (θ) | `[cosθ,-sinθ,0; sinθ,cosθ,0; 0,0,1]` |
| x軸反射 | `[1,0,0; 0,-1,0; 0,0,1]` |
| y軸反射 | `[-1,0,0; 0,1,0; 0,0,1]` |

---

## 8. 重要ポイントまとめ

1. **同次座標の点**: (x, y) → (x, y, 1)
2. **最下行は常に [0 0 1]**
3. **平行移動**: 3列目に移動量 (a, b)
4. **合成 AB**: B を先に、A を後に適用
5. **逆行列の順序**: (AB)⁻¹ = B⁻¹A⁻¹（順序が逆！）
6. **元に戻す**: 逆の順序で逆変換を適用

---
---

# Week 18: ガウス消去法（Gaussian Elimination）

## 1. 概要

**目的：** 連立一次方程式を行列を使って解く

行列は変換だけでなく、**線形代数**の基礎であり、機械学習などで重要。

---

## 2. 基本的な考え方

### 連立方程式を行列で表す

```
ax + by + cz = j
dx + ey + fz = k
gx + hy + iz = l
```

↓ 拡大係数行列（augmented matrix）

```
| a  b  c | j |
| d  e  f | k |
| g  h  i | l |
```

---

## 3. 行基本変形（Row Operations）

許される操作：
1. **行の入れ替え**
2. **行を定数倍する**
3. **ある行に別の行の定数倍を加える**

---

## 4. 目標：行階段形（Row Echelon Form）

対角線より左下をすべて **0** にする：

```
| *  *  * | * |
| 0  *  * | * |
| 0  0  * | * |
```

これにより、下から順に解ける！

---

## 5. 例題

### 連立方程式
```
 x - 3y + 5z = -9
2x -  y - 3z = 19
3x      + 4z = -13
```

### Step 1: 拡大係数行列を作る
```
|  1  -3   5 | -9  |
|  2  -1  -3 | 19  |
|  3   0   4 | -13 |
```

### Step 2: R₂' = R₂ - 2R₁（1列目の2を0に）
```
R₂': 2-2(1)=0, -1-2(-3)=5, -3-2(5)=-13, 19-2(-9)=37

|  1  -3   5  | -9  |
|  0   5  -13 | 37  |
|  3   0   4  | -13 |
```

### Step 3: R₃' = R₃ - 3R₁（1列目の3を0に）
```
R₃': 3-3(1)=0, 0-3(-3)=9, 4-3(5)=-11, -13-3(-9)=14

|  1  -3   5  | -9  |
|  0   5  -13 | 37  |
|  0   9  -11 | 14  |
```

### Step 4: R₃'' = R₃' - 2R₂'（2列目を0に）

※ 訂正: 実際は R₃ - (9/5)R₂ などの計算が必要だが、動画の例に従う

```
|  1  -3   5  | -9  |
|  0   5  -13 | 37  |
|  0   0   15 | -60 |
```

### Step 5: 後退代入（Back Substitution）

**z を求める：**
```
15z = -60
z = -4
```

**y を求める：**
```
5y - 13(-4) = 37
5y + 52 = 37
5y = -15
y = -3
```

**x を求める：**
```
x - 3(-3) + 5(-4) = -9
x + 9 - 20 = -9
x - 11 = -9
x = 2
```

### 解
```
x = 2, y = -3, z = -4
```

---

## 6. アルゴリズムの流れ

```
1. 拡大係数行列を作成
2. 1列目：R₂, R₃... の1列目を0にする
3. 2列目：R₃, R₄... の2列目を0にする
4. 繰り返して行階段形にする
5. 後退代入で下から順に解く
```

---

## 7. 重要ポイント

| ポイント | 内容 |
|----------|------|
| 行基本変形 | 行の加減算・定数倍・入れ替え |
| 目標 | 行階段形（左下が全て0） |
| 解き方 | 後退代入（下から順に） |
| 拡張性 | n元連立方程式にも適用可能 |

---

## 8. 余因子展開（3×3行列式）

### どの行・列でも展開可能

```
det(M) = a₁₁×C₁₁ + a₁₂×C₁₂ + a₁₃×C₁₃  （1行目展開）
det(M) = a₂₁×C₂₁ + a₂₂×C₂₂ + a₂₃×C₂₃  （2行目展開）
```

**コツ：0が多い行や列で展開すると計算が楽**

---

## 9. 逆行列の存在条件

1. **正方行列**である（行数 = 列数）
2. **行列式 ≠ 0**

---
---

# 練習問題と解答

## 同次座標

### Q4: 同次座標で3列目を非ゼロにすると？
**A:** 平行移動（translation）が起こる

### Q5: 同次座標の変換行列の特徴は？
**A:** 最下行は常に [0 0 1]

---

## ガウス消去法

### Q6: ガウス消去法の主な目的は？
**A:** 行階段形（row echelon form）を得ること

### Q7: 行階段形の定義的特徴は？
**A:** 各行の先頭要素が、上の行の先頭要素より右にある（階段状）

### Q8: ガウス消去法で解くのは？
**A:** 連立一次方程式（systems of linear equations）

### Q9: 行階段形の後、解はどう求める？
**A:** 下から上へ後退代入（back-substitution）

### Q10: 行階段形の後の次のステップは？
**A:** 後退代入で変数の値を求める

---

## ベクトル

### Q1: 右に7歩、前に5歩の変位ベクトルは？
**A:** (7, 5)

### Q2: 点A(2,5)から点B(7,1)へのベクトルvは？
**A:** v = B - A = (5, -4)、v = AB

### Q3: ベクトル(3, -2)の大きさは？
**A:** √(3² + (-2)²) = √13 ≈ 3.61

### Q4: Q - P の意味は？
**A:** Pを始点、Qを終点とするベクトル（P → Q）

### Q5: ベクトル(5, -2)を-4倍すると？
**A:** (-20, 8)　※全座標を-4倍

### Q6: (-6,-8) + (-4,6) = ?
**A:** (-10, -2)

### Q7: (3,-6) - (-5,2) = ?
**A:** (8, -8)　※引き算は足し算に変換: (3,-6) + (5,-2)

### Q8: 内積 (1,2)·(3,4) = ?
**A:** 1×3 + 2×4 = 11

---

## 行列の演算

### Q9: 行列×ベクトル (3,4; -2,1) × (3,-3)
**A:** (3×3+4×(-3), -2×3+1×(-3)) = (-3, -9)

### Q10: 3×3行列 × 3×1ベクトル
**A:** 各行と列ベクトルの内積を計算

### Q11: 行列×変数ベクトル (5,2; 3,6) × (x,y)
**A:** (5x+2y, 3x+6y)

### Q12: 行列の足し算 (-3,4; 5,-5) + (3,7; 2,-3)
**A:** (0,11; 7,-8)

### Q13: 3×3 × 2×2 は計算可能？
**A:** 不可能（列数3 ≠ 行数2）

### Q14: (-3,4; 5,-5) × (6,-5)
**A:** (-38, 23)

### Q16: 2×2行列同士の掛け算
**A:** 行×列の組み合わせで4要素を計算

---

## 行列式と逆行列

### Q17: det(5,2; 3,4) = ?
**A:** 5×4 - 2×3 = 14

### Q18: 3×3行列式の余因子展開
**A:** 任意の行・列で展開可能、結果は同じ

### Q19: 3×2行列の逆行列は？
**A:** 存在しない（正方行列でないため）

### Q20: (3,1; 4,2)の逆行列
```
det = 3×2 - 1×4 = 2
A⁻¹ = (1/2) × (2,-1; -4,3) = (1,-1/2; -2,3/2)
```

### Q21: 逆行列で連立方程式を解く
```
3x + y = 5
2x - y = 0

A⁻¹ = -1/5 × (-1,-1; -2,3)
(x,y) = A⁻¹ × (5,0) = (1, 2)
```

### Q22: (2,1; 3,4) × (x,y) = ?
**A:** (2x+y, 3x+4y)

---

## 逆行列の合成公式

### (AB)⁻¹ = B⁻¹A⁻¹ の証明

**証明：**
```
(AB) × (B⁻¹A⁻¹) = A(BB⁻¹)A⁻¹ = AIA⁻¹ = AA⁻¹ = I ✓
(B⁻¹A⁻¹) × (AB) = B⁻¹(A⁻¹A)B = B⁻¹IB = B⁻¹B = I ✓
```
両方Iになる → 逆行列の定義を満たす

---
---

# Topic 9 (Vectors & Matrices) 総まとめ

| Week | 内容 |
|------|------|
| Week 17 | 2×2行列による変換（回転・反射・拡大・せん断）|
| Week 18 | 同次座標（平行移動）、ガウス消去法（連立方程式）|

## 重要公式一覧

| 項目 | 公式 |
|------|------|
| ベクトルの大きさ | \|v\| = √(x² + y²) |
| 内積 | (a,b)·(c,d) = ac + bd |
| 2×2行列式 | det = ad - bc |
| 2×2逆行列 | A⁻¹ = (1/det) × (d,-b; -c,a) |
| 逆行列の合成 | (AB)⁻¹ = B⁻¹A⁻¹ |
| 同次座標の点 | (x,y) → (x,y,1) |
| 平行移動行列 | [1,0,a; 0,1,b; 0,0,1] |
